* GENERATED BY CHARMM-GUI (http://www.charmm-gui.org) v1.8 on Feb, 06. 2017. JOBID=1486388593
* READ PDB, MANIPULATE STRUCTURE IF NEEDED, AND GENERATE TOPOLOGY FILE
*

DIMENS CHSIZE 3000000 MAXRES 3000000

prnlev 5
bomlev -1

! Read topology and parameter files
stream toppar.str

! Read SCN
open read card unit 10 name init.scn.pdb
read sequence pdb unit 10
generate LIG setup warn first none last none

open read card unit 10 name init.scn.pdb
read coor pdb  unit 10 resid
! END SCN

! Read POT
open read card unit 10 name init.pot.pdb
read sequence pdb unit 10
generate POT setup warn first none last none

open read card unit 10 name init.pot.pdb
read coor pdb  unit 10 resid
! END POT

! Read ACEM
open read card unit 10 name init.acem.pdb
read sequence pdb unit 10
generate ACM setup warn first none last none

open read card unit 10 name init.acem.pdb
read coor pdb  unit 10 resid
! END ACEM

! Read TIP3
open read card unit 10 name init.tip3.pdb
read sequence pdb unit 10
generate WAT setup noang nodihe

open read card unit 10 name init.tip3.pdb
read coor pdb  unit 10 resid
! END TIP3

!
! Setup PBC (Periodic Boundary Condition)
!

coor stat sele all end

calc xdim = int ( ( ?xmax - ?xmin + 0.0 ) ) + 1
calc ydim = int ( ( ?ymax - ?ymin + 0.0 ) ) + 1
calc zdim = int ( ( ?zmax - ?zmin + 0.0 ) ) + 1


set bsiz = 0
if @xdim .gt. @bsiz then
   set bsiz = @xdim
endif

if @ydim .gt. @bsiz then
   set bsiz = @ydim
endif

if @zdim .gt. @bsiz then
   set bsiz = @zdim
endif


open read unit 10 card name crystal_image.str
crystal defi cubic @bsiz @bsiz @bsiz 90. 90. 90.
crystal build nope 0
image byres xcen 0.0 ycen 0.0 zcen 0.0 sele all end




open write card unit 10 name step1_pdbreader.pdb
write coor pdb  unit 10 official

open write card unit 10 name step1_pdbreader.crd
write coor unit 10 card

open write unit 10 card name step1_pdbreader.psf
write psf  unit 10 card



stop



